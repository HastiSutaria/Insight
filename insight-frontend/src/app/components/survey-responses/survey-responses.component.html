<body>
  <div class="container">
    <div class="mt-4 heading">
      <h2>Responses</h2>
      <button type="button" class="btn clk-button" (click)="saveToExcel()">
        <i class="bi bi-file-earmark-spreadsheet-fill" style="color: white"></i>
        Download Data
      </button>
    </div>
    <div class="list-group pt-3">
      <div class="mt-3 ">
        <table mat-table [dataSource]="dataSource" matSort (matSortChange)="announceSortChange($event)"
       class="mat-elevation-z8">
          <ng-container
            *ngFor="let col of dynamicColumns"
            matColumnDef="{{ col }}"
          >
            <th  mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort">{{ col }}</th>
            <td mat-cell *matCellDef="let element">{{ element[col] }}</td>
          </ng-container>

          <tr class="table-header" mat-header-row *matHeaderRowDef="dynamicColumns"></tr>
          <tr class = "table-rows" mat-row *matRowDef="let row; columns: dynamicColumns"></tr>
        </table>
        
      </div>
      
    </div>
    <mat-paginator class="mt-2"
          [pageSizeOptions]="[5, 10, 20]"
          showFirstLastButtons
          aria-label="Select page of survey responses"
        >
        </mat-paginator>
  </div>
  <!-- <div class="container mt-5">
    <h2>Analytics</h2>
    <div class="chart">
      <canvas #chart></canvas>
      <canvas #chart2></canvas>
    </div>
  </div> -->
</body>
